define(["exports","require","./my-app.js"],function(_exports,_require,_myApp){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.createSelectorCreator=createSelectorCreator;_exports.createStructuredSelector=createStructuredSelector;_exports.defaultMemoize=defaultMemoize;_exports.selectMarkdown=_exports.selectKey=_exports.selectArticles=_exports.selectArticle=_exports.highlightCode=_exports.createSelector=_exports.convertMarkdownToHtml=_exports.$routeDataSelectors=_exports.$markdownService=_exports.$index=_exports.$articleSelectors=void 0;_require=babelHelpers.interopRequireWildcard(_require);function _templateObject3_adba1e60f48e11e9a07a2bd8b660e33f(){var data=babelHelpers.taggedTemplateLiteral(["\n      <link rel=\"stylesheet\" href=\"/node_modules/prismjs/themes/prism-tomorrow.css\" />\n\n      <section>\n        <article>\n          <header>\n            <h2>","</h2>\n          </header>\n          <time datetime=\"","\">Originally written on ",". Revised on ","</time>\n\n          ","\n\n          <footer>\n            If you have any questions or feedback, please feel free to reach out to me\n            <a href=\"https://twitter.com/mikegeyser\" target=\"_blank\"> on twitter</a> or\n            <a href=\"https://github.com/mikegeyser/self/issues/","\" target=\"_blank\">\n              join the discussion on github</a\n            >.\n          </footer>\n        </article>\n      </section>\n    "]);_templateObject3_adba1e60f48e11e9a07a2bd8b660e33f=function _templateObject3_adba1e60f48e11e9a07a2bd8b660e33f(){return data};return data}function _templateObject2_adba1e60f48e11e9a07a2bd8b660e33f(){var data=babelHelpers.taggedTemplateLiteral([""]);_templateObject2_adba1e60f48e11e9a07a2bd8b660e33f=function _templateObject2_adba1e60f48e11e9a07a2bd8b660e33f(){return data};return data}function _templateObject_adba1e60f48e11e9a07a2bd8b660e33f(){var data=babelHelpers.taggedTemplateLiteral(["\n  time {\n    font-style: italic;\n    padding: 0 0 0 8px;\n  }\n\n  p,\n  li,\n  footer {\n    font-size: 15pt;\n    line-height: 19pt;\n    text-align: justify;\n  }\n\n  footer {\n    margin: 2em 0.5em 1em 0.5em;\n    font-style: italic;\n  }\n\n  img {\n    max-width: 100%;\n    width: inherit;\n    display: block;\n    margin: auto;\n  }\n"]);_templateObject_adba1e60f48e11e9a07a2bd8b660e33f=function _templateObject_adba1e60f48e11e9a07a2bd8b660e33f(){return data};return data}function defaultEqualityCheck(a,b){return a===b}function areArgumentsShallowlyEqual(equalityCheck,prev,next){if(null===prev||null===next||prev.length!==next.length){return!1}// Do this in a for loop (and not a `forEach` or an `every`) so we can determine equality as fast as possible.
for(var length=prev.length,i=0;i<length;i++){if(!equalityCheck(prev[i],next[i])){return!1}}return!0}function defaultMemoize(func){var equalityCheck=1<arguments.length&&arguments[1]!==void 0?arguments[1]:defaultEqualityCheck,lastArgs=null,lastResult=null;// we reference arguments instead of spreading them for performance reasons
return function(){if(!areArgumentsShallowlyEqual(equalityCheck,lastArgs,arguments)){// apply arguments instead of spreading for performance.
lastResult=func.apply(null,arguments)}lastArgs=arguments;return lastResult}}function getDependencies(funcs){var dependencies=Array.isArray(funcs[0])?funcs[0]:funcs;if(!dependencies.every(function(dep){return"function"===typeof dep})){var dependencyTypes=dependencies.map(function(dep){return babelHelpers.typeof(dep)}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, "+("instead received the following types: ["+dependencyTypes+"]"))}return dependencies}function createSelectorCreator(memoize){for(var _len=arguments.length,memoizeOptions=Array(1<_len?_len-1:0),_key=1;_key<_len;_key++){memoizeOptions[_key-1]=arguments[_key]}return function(){for(var _len2=arguments.length,funcs=Array(_len2),_key2=0;_key2<_len2;_key2++){funcs[_key2]=arguments[_key2]}var recomputations=0,resultFunc=funcs.pop(),dependencies=getDependencies(funcs),memoizedResultFunc=memoize.apply(void 0,[function(){recomputations++;// apply arguments instead of spreading for performance.
return resultFunc.apply(null,arguments)}].concat(memoizeOptions)),selector=memoize(function(){for(var params=[],length=dependencies.length,i=0;i<length;i++){// apply arguments instead of spreading and mutate a local list of params for performance.
params.push(dependencies[i].apply(null,arguments))}// apply arguments instead of spreading for performance.
return memoizedResultFunc.apply(null,params)});selector.resultFunc=resultFunc;selector.dependencies=dependencies;selector.recomputations=function(){return recomputations};selector.resetRecomputations=function(){return recomputations=0};return selector}}var createSelector=createSelectorCreator(defaultMemoize);_exports.createSelector=createSelector;function createStructuredSelector(selectors){var selectorCreator=1<arguments.length&&arguments[1]!==void 0?arguments[1]:createSelector;if("object"!==babelHelpers.typeof(selectors)){throw new Error("createStructuredSelector expects first argument to be an object "+("where each property is a selector, instead received a "+babelHelpers.typeof(selectors)))}var objectKeys=Object.keys(selectors);return selectorCreator(objectKeys.map(function(key){return selectors[key]}),function(){for(var _len3=arguments.length,values=Array(_len3),_key3=0;_key3<_len3;_key3++){values[_key3]=arguments[_key3]}return values.reduce(function(composition,value,index){composition[objectKeys[index]]=value;return composition},{})})}var index={defaultMemoize:defaultMemoize,createSelectorCreator:createSelectorCreator,createSelector:createSelector,createStructuredSelector:createStructuredSelector};_exports.$index=index;var selectKey=function selectKey(state){return state.app.routeData&&state.app.routeData.length&&state.app.routeData[0]};_exports.selectKey=selectKey;var routeData_selectors={selectKey:selectKey};_exports.$routeDataSelectors=routeData_selectors;var selectArticles=function selectArticles(state){return state.content.articles};_exports.selectArticles=selectArticles;var selectArticle=createSelector(selectArticles,selectKey,function(articles,key){return articles.find(function(article){return article.key===key})});_exports.selectArticle=selectArticle;var selectMarkdown=function selectMarkdown(state){return state.content.markdown};_exports.selectMarkdown=selectMarkdown;var article_selectors={selectArticles:selectArticles,selectArticle:selectArticle,selectMarkdown:selectMarkdown};_exports.$articleSelectors=article_selectors;var converter=new showdown.Converter({tables:!0,metadata:!0}),rewriteMarkdownImagePaths=function rewriteMarkdownImagePaths(fileLocation,htmlText){var imagePath=fileLocation.substr(0,fileLocation.lastIndexOf("/")),regEx=/(img.*?)src="(.*?)"(\s)/gi;return htmlText.replace(regEx,"$1 src=\"courses/".concat(imagePath,"/$2\" $3"))},convertMarkdownToHtml=function convertMarkdownToHtml(markdown,path,languages){var htmlText=converter.makeHtml(markdown),parser=new DOMParser,element=parser.parseFromString(htmlText,"text/html").documentElement;// htmlText = rewriteMarkdownImagePaths(path, htmlText);
highlightCode(element,languages);return element};_exports.convertMarkdownToHtml=convertMarkdownToHtml;var prism_base_url="/node_modules/prismjs",highlightCode=/*#__PURE__*/function(){var _ref=babelHelpers.asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee(element){var languages,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:languages=1<_args.length&&_args[1]!==void 0?_args[1]:[];new Promise(function(res,rej){return _require.default(["".concat(prism_base_url,"/prism.js")],res,rej)}).then(function(){return Promise.all(babelHelpers.toConsumableArray(languages.map(function(language){return new Promise(function(res,rej){return _require.default(["".concat(prism_base_url,"/components/prism-").concat(language,".js")],res,rej)})})))}).then(function(_){return Prism.highlightAllUnder(element)});case 2:case"end":return _context.stop();}}},_callee,this)}));return function highlightCode(_x){return _ref.apply(this,arguments)}}();_exports.highlightCode=highlightCode;var markdown_service={convertMarkdownToHtml:convertMarkdownToHtml,highlightCode:highlightCode};_exports.$markdownService=markdown_service;var styles=(0,_myApp.css)(_templateObject_adba1e60f48e11e9a07a2bd8b660e33f()),Article=/*#__PURE__*/function(_connect){babelHelpers.inherits(Article,_connect);function Article(){babelHelpers.classCallCheck(this,Article);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(Article).apply(this,arguments))}babelHelpers.createClass(Article,[{key:"render",value:function render(){var article=this.article,content=this.content;if(!article)return(0,_myApp.html)(_templateObject2_adba1e60f48e11e9a07a2bd8b660e33f());return(0,_myApp.html)(_templateObject3_adba1e60f48e11e9a07a2bd8b660e33f(),article.title,article.date,article.date,article.revised,content,article.issue)}},{key:"updated",value:function updated(changedProperties){if(changedProperties.has("article")&&this.article){(0,_myApp.getMarkdown)(this.article.path);var pageTitle=this.article.title+" // mikerambl.es";(0,_myApp.updateMetadata)({title:pageTitle,description:this.article.summary,url:window.location.url})}}},{key:"stateChanged",value:function stateChanged(state){this.article=selectArticle(state);var markdown=selectMarkdown(state);if(markdown&&this.article){this.content=convertMarkdownToHtml(markdown,this.article.path,this.article.languages)}}}],[{key:"properties",get:function get(){return{article:Object,content:String}}},{key:"styles",get:function get(){return[_myApp.SharedStyles,styles]}}]);return Article}((0,_myApp.connect)(_myApp.store)(_myApp.PageViewElement));window.customElements.define("m-article",Article)});